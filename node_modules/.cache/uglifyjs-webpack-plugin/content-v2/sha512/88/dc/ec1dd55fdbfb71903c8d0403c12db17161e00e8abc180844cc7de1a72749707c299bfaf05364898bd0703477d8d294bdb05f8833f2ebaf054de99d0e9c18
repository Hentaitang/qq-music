{"code":"!function(e){var t={};function n(i){if(t[i])return t[i].exports;var s=t[i]={i:i,l:!1,exports:{}};return e[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var s in e)n.d(i,s,function(t){return e[t]}.bind(null,s));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=1)}([function(e,t){document.addEventListener(\"click\",function(e){var t=e.target;if(\"tab\"===t.dataset.role){[].forEach.call(t.parentElement.children,function(e){e.classList.remove(\"active\")}),t.classList.add(\"active\");var n=document.querySelector(t.dataset.view);n&&([].forEach.call(n.parentElement.children,function(e){e.style.display=\"none\"}),n.style.display=\"block\")}})},function(e,t,n){\"use strict\";n.r(t);n(0);function i(e){var t=[].slice.call(e);if(\"IntersectionObserver\"in window){var n=new IntersectionObserver(function(e){e.forEach(function(e){e.intersectionRatio>0&&s(e.target,function(){n.unobserve(e.target)})})},{threshold:.01});t.forEach(function(e){return n.observe(e)})}else{var i=function(e,t){var n,i;return function s(){var r=Date.now(),a=r-n;!n||a>=t?(e(),n=r):a<t&&(clearTimeout(i),i=setTimeout(s,t-a))}}(function(){if(0===t.length)return window.removeEventListener(\"scroll\",i);(t=t.filter(function(e){return e.classList.contains(\"lazyload\")})).forEach(function(e){(function(e){var t=e.getBoundingClientRect(),n=t.top,i=t.left,s=t.right,r=t.bottom,a=document.documentElement.clientHeight,o=document.documentElement.clientWidth;return(n>0&&n<a||r>0&&r<a)&&(i>0&&i<o||s>0&&s<o)})(e)&&s(e)})},500);window.addEventListener(\"scroll\",i),window.dispatchEvent(new Event(\"scroll\"))}function s(e,t){var n=new Image;n.src=e.dataset.src,n.onload=function(){e.src=n.src,e.classList.remove(\"lazyload\")},\"function\"==typeof t&&t()}}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.$el=t.el,this.slides=t.slides,this.render()}return function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)}(e,[{key:\"render\",value:function(){this.$el.innerHTML='\\n        <div class=\"qq-slider-wrap\">\\n            <div class=\"swiper-container\">\\n                <div class=\"swiper-wrapper\">\\n                </div>\\n                <div class=\"swiper-pagination\"></div>\\n            </div>\\n        </div>\\n        ',this.$wrap=this.$el.querySelector(\".swiper-wrapper\"),this.$wrap.innerHTML=this.slides.map(function(e){return'<div class=\"swiper-slide\">\\n                <div class=\"qq-slider-item\">\\n                    <a href=\"'.concat(e.link,'\">\\n                        <img src=\"').concat(e.image,'\">\\n                    </a>\\n                </div>\\n            </div>\\n            ')}).join(\"\")}}]),e}();function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.$el=t}return function(e,t,n){t&&a(e.prototype,t),n&&a(e,n)}(e,[{key:\"launch\",value:function(){var e=this;return fetch(\"https://qq-music-api.now.sh\").then(function(e){return e.json()}).then(function(t){e.render(t)}).then(function(){return e.loading()}),this}},{key:\"render\",value:function(e){this.renderSlider(e.data.slider),$(),this.renderRadio(e.data.radioList),this.renderSong(e.data.songList),i(this.$el.querySelectorAll(\".lazyload\"))}},{key:\"loading\",value:function(){var e=this.$el.querySelector(\"#loading\"),t=document.querySelector(\"#body\");e.classList.add(\"hidden\"),t.classList.remove(\"all-load\")}},{key:\"renderSlider\",value:function(e){e=e.map(function(e){return{link:e.linkUrl,image:e.picUrl}}),new r({el:this.$el.querySelector(\"#slider\"),slides:e})}},{key:\"renderRadio\",value:function(e){this.$el.querySelector(\".radio .list\").innerHTML=e.map(function(e){return'<div class=\"list-item\">\\n            <div class=\"list-media\">\\n                <img class=\"lazyload\" src=\"./images/default-pic.jpg\" data-src=\"'.concat(e.picUrl,'\">\\n                <span class=\"icon icon_play\"></span>\\n            </div>\\n            <div class=\"list-title\">').concat(e.Ftitle,\"</div>\\n        </div>\")}).join(\"\")}},{key:\"renderSong\",value:function(e){this.$el.querySelector(\".song .list\").innerHTML=e.map(function(e){return'<div class=\"list-item\">\\n                <div class=\"list-media\">\\n                    <img class=\"lazyload\" src=\"./images/default-pic.jpg\" data-src=\"'.concat(e.picUrl,'\">\\n                    <span class=\"icon icon_play\"></span>\\n                </div>\\n                <div class=\"list-title\">').concat(e.songListDesc,\"</div>\\n            </div>\")}).join(\"\")}}]),e}();function c(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||\"[object Arguments]\"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}function l(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.$el=t,this.$input=this.$el.querySelector(\"#search\"),this.$input.addEventListener(\"keyup\",this.onKeyUp.bind(this)),this.$input.addEventListener(\"input\",this.oninput.bind(this)),this.keyword=\"\",this.$songs=document.querySelector(\"#song-list\"),this.page=1,this.songs=[],this.nomore=!1,this.perpage=20,this.fetching=!1,this.onscroll=this.onScroll.bind(this),window.addEventListener(\"scroll\",this.onscroll)}return function(e,t,n){t&&l(e.prototype,t),n&&l(e,n)}(e,[{key:\"onScroll\",value:function(e){this.nomore||document.documentElement.clientHeight+pageYOffset>document.body.scrollHeight-50&&this.search(this.keyword,this.page+1)}},{key:\"oninput\",value:function(e){if(!e.target.value)return this.reset()}},{key:\"onKeyUp\",value:function(e){var t=e.target.value;13===e.keyCode&&this.search(t)}},{key:\"reset\",value:function(){this.page=1,this.keyword=\"\",this.songs=[],this.$songs.innerHTML=\"\"}},{key:\"search\",value:function(e,t){var n=this;if(!this.fetching){this.fetching=!0,this.keyword=e;this.$songs.insertAdjacentHTML(\"beforeend\",'<div class=\"searching\"><img src=\"./images/icon_loading.png\"><span>正在加载更多...</span></div>'),fetch(\"https://qq-music-api.now.sh/search?keyword=\".concat(this.keyword,\"&page=\").concat(t||this.page)).then(function(e){return e.json()}).then(function(e){var t;return n.page=e.data.song.curpage,n.nomore=\"no results\"===e.message,(t=n.songs).push.apply(t,c(e.data.song.list)),e.data}).then(function(e){return n.append(e)}).then(function(){n.fetching=!1})}}},{key:\"append\",value:function(e){if(e.zhida.songnum){var t='\\n            <a class=\"song-item\" href=\"#\">\\n                <div class=\"artist-image\"><img src=\"https://y.gtimg.cn/music/photo_new/T001R68x68M000'.concat(e.zhida.singermid,'.jpg?max_age=2592000\"></div>\\n                <div class=\"song-name ellipsis\">').concat(e.zhida.singername,'</div>\\n                <div class=\"song-artist ellipsis\"><span>单曲：').concat(e.zhida.songnum,\"</span><span>专辑：\").concat(e.zhida.albumnum,\"</span></div>\\n            </a>\");this.$songs.insertAdjacentHTML(\"beforeend\",t)}var n=e.song.list.map(function(e){return'\\n            <a class=\"song-item\" \\n            href=\"#player?singer='.concat(e.singer.map(function(e){return e.name}).join(\" / \"),\"&albummid=\").concat(e.albummid,\"&songname=\").concat(e.songname,\"&songid=\").concat(e.songid,\"&duration=\").concat(e.interval,\"&songmid=\").concat(e.songmid,'\">\\n                <div class=\"icon-image\"><img src=\"./images/search-sprite.png\"></div>\\n                <div class=\"song-name ellipsis\">').concat(e.songname,'</div>\\n                <div class=\"song-artist ellipsis\">').concat(e.singer.map(function(e){return e.name}).join(\" / \"),\"</div>\\n            </a>\")}).join(\"\");if(this.$songs.insertAdjacentHTML(\"beforeend\",n),this.nomore){this.$songs.insertAdjacentHTML(\"beforeend\",\"<p>已加载全部</p>\")}this.$songs.querySelector(\".searching\").classList.add(\"hide\"),this.$songs.querySelector(\".searching.hide\").style.display=\"none\",this.$songs.querySelector(\".searching.hide\").classList.remove(\"searching\")}}]),e}();function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var h=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.$el=t,this.$el.innerHTML='<div class=\"player-lyrics-lines\"></div>',this.$lines=this.$el.querySelector(\".player-lyrics-lines\"),this.text=\"\",this.index=0,this.lyrics=[],this.elapsed=0,this.$audio=n,this.reset(this.text)}return function(e,t,n){t&&d(e.prototype,t),n&&d(e,n)}(e,[{key:\"start\",value:function(){this.intervalName=setInterval(this.update.bind(this),1e3)}},{key:\"pause\",value:function(){clearInterval(this.intervalName)}},{key:\"update\",value:function(){if(this.elapsed=Math.round(this.$audio.currentTime),this.index===this.lyrics.length-1)return this.reset();for(var e=this.index+1;e<this.lyrics.length;e++){var t=this.getSeconds(this.lyrics[e]);if(this.elapsed===t&&(!this.lyrics[e+1]||this.elapsed<this.getSeconds(this.lyrics[e+1]))){this.$lines.children[this.index].classList.remove(\"active\"),this.$lines.children[e].classList.add(\"active\"),this.index=e;break}}if(this.index>2){var n=-(this.index-2)*this.LINE_HEIGHT;this.$lines.style.transform=\"translateY(\".concat(n,\"px)\")}}},{key:\"render\",value:function(){var e=this.lyrics.map(function(e){return'\\n            <div class=\"player-lyrics-line\">'.concat(e.slice(10),\"</div>\\n        \")}).join(\"\");this.$lines.innerHTML=e}},{key:\"reset\",value:function(e){e&&(this.text=this.formatText(e)||\"\",this.lyrics=this.text.match(/^\\[\\d{2}:\\d{2}\\.\\d{2}\\](.+)$/gm)||[],this.lyrics.length&&(this.render(),this.$lines.children[this.index].classList.remove(\"active\"),this.$lines.children[0].classList.add(\"active\"),this.$lines.style.transform=\"translateY(0px)\")),this.pause(),this.index=0,this.elapsed=0}},{key:\"restart\",value:function(){this.reset(),this.start()}},{key:\"getSeconds\",value:function(e){return+e.replace(/^\\[(\\d{2}):(\\d{2}).*/,function(e,t,n){return 60*+t+ +n})}},{key:\"formatText\",value:function(e){var t=document.createElement(\"div\");return t.innerHTML=e,t.innerText}}]),e}();function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}h.prototype.LINE_HEIGHT=42;var f=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.$el=t,this.elapsed=0,this.duration=n||0,this.progress=0,this.render(),this.$progress=this.$el.querySelector(\".progress-action\"),this.$elapsed=this.$el.querySelector(\".progress-elapsed\"),this.$duration=this.$el.querySelector(\".progress-duration\"),this.$elapsed.innerHTML=this.formatTime(this.elapsed),this.$duration.innerHTML=this.formatTime(this.duration),i&&this.start()}return function(e,t,n){t&&p(e.prototype,t),n&&p(e,n)}(e,[{key:\"start\",value:function(){this.intervalName=setInterval(this.update.bind(this),50)}},{key:\"pause\",value:function(){clearInterval(this.intervalName)}},{key:\"update\",value:function(){this.elapsed+=.05,this.elapsed>=this.duration&&this.reset(),this.progress=this.elapsed/this.duration,this.$progress.style.transform=\"translateX(\".concat(100*this.progress-100,\"%)\"),this.$elapsed.innerText=this.formatTime(this.elapsed)}},{key:\"reset\",value:function(e){this.pause(),this.elapsed=0,this.progress=0,e&&(this.duration=e,this.$duration.innerText=this.formatTime(this.duration),this.$elapsed.innerText=this.formatTime(this.elapsed),this.$progress.style.transform=\"translateX(-100%)\")}},{key:\"render\",value:function(){this.$el.innerHTML='\\n        <div class=\"progress-time progress-elapsed\"></div>\\n        <div class=\"progress-bar\">\\n            <div class=\"progress-action\"></div>\\n        </div>\\n        <div class=\"progress-time progress-duration\"></div> \\n        '}},{key:\"formatTime\",value:function(e){var t=Math.floor(e/60),n=Math.floor(e%60);return t<10&&(t=\"0\"+t),n<10&&(n=\"0\"+n),\"\".concat(t,\":\").concat(n)}}]),e}();function v(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var y=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.$el=t,this.$el.addEventListener(\"click\",this),this.createAudio(),this.lyrics=new h(document.querySelector(\".player-lyrics\"),this.$audio),this.progress=new f(document.querySelector(\".progress\"))}return function(e,t,n){t&&v(e.prototype,t),n&&v(e,n)}(e,[{key:\"createAudio\",value:function(){var e=this;this.$audio=document.createElement(\"audio\"),this.$audio.id=\"player-\".concat(Math.floor(100*Math.random())),this.$audio.addEventListener(\"ended\",function(){e.lyrics.reset(),e.progress.reset();var t=document.querySelector(\".icon-pause\");t&&(t.classList.add(\"icon-play\"),t.classList.remove(\"icon-pause\"))}),body.appendChild(this.$audio)}},{key:\"handleEvent\",value:function(e){var t=e.target;switch(!0){case t.matches(\".icon-play\"):this.onPlay(t);break;case t.matches(\".icon-pause\"):this.onPause(t);break;case t.matches(\"#icon-list\"):this.hide(t);break;case t.matches(\"#button\"):this.hide(t.parentNode)}}},{key:\"onPause\",value:function(e){this.$audio.pause(),this.progress.pause(),this.lyrics.pause(),e.classList.add(\"icon-play\"),e.classList.remove(\"icon-pause\")}},{key:\"onPlay\",value:function(e){this.$audio.play(),this.progress.start(),this.lyrics.start(),e.classList.add(\"icon-pause\"),e.classList.remove(\"icon-play\")}},{key:\"hide\",value:function(e){e.parentNode.parentNode.classList.remove(\"show\"),document.querySelector(\"#body\").classList.remove(\"all-load\")}},{key:\"play\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t){this.$el.querySelector(\".album-image\").src=\"https://y.gtimg.cn/music/photo_new/T002R150x150M000\".concat(t.albummid,\".jpg\"),this.$el.querySelector(\".background-image\").style.backgroundImage='url(\"https://y.gtimg.cn/music/photo_new/T002R150x150M000'.concat(t.albummid,'.jpg\")'),this.$el.querySelector(\".song-name\").innerText=\"\".concat(t.songname),this.$el.querySelector(\".song-artist\").innerText=\"\".concat(t.singer),this.progress.reset(t.duration);var n=document.querySelector(\".icon-pause\");n&&(n.classList.add(\"icon-play\"),n.classList.remove(\"icon-pause\")),t.songid&&(this.$audio.src=\"http://ws.stream.qqmusic.qq.com/C100\".concat(t.songmid,\".m4a?fromtag=0&guid=126548448\"),fetch(\"https://qq-music-api.now.sh/lyrics?id=\".concat(t.songid,\"}\")).then(function(e){return e.json()}).then(function(e){return e.lyric}).then(function(t){return e.lyrics.reset(t)}).catch(function(){})),this.show()}}},{key:\"show\",value:function(){this.$el.classList.add(\"show\"),document.querySelector(\"#body\").classList.add(\"all-load\")}}]),e}();function m(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,\"value\"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,e),this.$el=t}return function(e,t,n){t&&m(e.prototype,t),n&&m(e,n)}(e,[{key:\"launch\",value:function(){var e=this;return fetch(\"https://qq-music-api.now.sh/top\").then(function(e){return e.json()}).then(function(t){return e.renderTopList(t.data.topList)}),this}},{key:\"renderTopList\",value:function(e){this.$el.querySelector(\".topList\").innerHTML=e.map(function(e){return'<li class=\"list-item\">\\n                <div class=\"list-media\">\\n                    <a href=\"#\">\\n                        <img data-src=\"'.concat(e.picUrl,'\" class=\"lazyload\">\\n                    </a>\\n                </div>\\n                <div class=\"list-title\">\\n                    <div class=\"title\">\\n                        <h3>').concat(e.topTitle,\"</h3>\\n                        <p>1<span>\").concat(e.songList[0].songname,\"</span>-\").concat(e.songList[0].singername,\"</p>\\n                        <p>2<span>\").concat(e.songList[1].songname,\"</span>-\").concat(e.songList[1].singername,\"</p>\\n                        <p>3<span>\").concat(e.songList[2].songname,\"</span>-\").concat(e.songList[2].singername,\"</p>\\n                    </div>\\n                </div>\\n            </li>\")}).join(\"\"),i(this.$el.querySelectorAll(\".lazyload\"))}}]),e}();n.d(t,\"swiper\",function(){return $});new o(document.querySelector(\"#rec-view\")).launch(),new g(document.querySelector(\"#rank-view\")).launch(),new u(document.querySelector(\".search-view\"));var b=new y(document.querySelector(\"#music-player\"));function w(){if(/^#player\\?.+/.test(location.hash)){var e=location.hash.indexOf(\"?\")+1,t=decodeURIComponent(location.hash).slice(e).match(/(\\w+)=([^&]+)/g).reduce(function(e,t){var n=t.split(\"=\");return e[n[0]]=n[1],e},{});b.play(t)}}function $(){new Swiper(\".swiper-container\",{slidesPerView:1,centeredSlides:!0,autoplay:{delay:2500,disableOnInteraction:!1},loop:!0,pagination:{el:\".swiper-pagination\",clickable:!0},navigation:{nextEl:\".swiper-button-next\",prevEl:\".swiper-button-prev\"}})}document.querySelector(\"#play-button\").addEventListener(\"click\",function(){b.show()}),w(),window.addEventListener(\"hashchange\",w)}]);","extractedComments":[]}